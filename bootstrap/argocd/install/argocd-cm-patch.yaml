apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-cm
  namespace: argocd
data:
  # Enable Kustomize plugins for KSOPS
  kustomize.buildOptions: "--enable-alpha-plugins --enable-exec"
  
  # Exclude Crossplane-generated composite resources from ArgoCD tracking
  # These X* resources are dynamically created by Crossplane when Claims are applied
  # ArgoCD should only manage the Claims, not the Composites
  # This is required in BOTH preview and production environments
  resource.exclusions: |
    - apiGroups:
        - platform.bizmatters.io
      kinds:
        - XEventDrivenService
      clusters:
        - "*"
    - apiGroups:
        - database.bizmatters.io
      kinds:
        - XPostgresInstance
        - XDragonflyInstance
      clusters:
        - "*"